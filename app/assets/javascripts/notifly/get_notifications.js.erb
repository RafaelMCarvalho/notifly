<% notifly = Notifly::Engine.routes.url_helpers %>
var notiflyNotificationsRequested;

var _notiflyGetNotifications = function () {
  var $notifly = $('#notifly-icon');

  $notifly.click(function () {
    if (!notiflyNotificationsRequested) {
      notiflyNotificationsRequested = true;

      $.ajax({
        url: '<%= notifly.notifications_path %>',
        type: 'GET',
        error: _notiflyHandleNotificationsError
      });
    }
  });
};

var _notiflyHandleNotificationsError = function () {
  notiflyNotificationsRequested = false;
};

$(document).ready(function() {
  _notiflyGetNotifications();
});