<% notifly = Notifly::Engine.routes.url_helpers %>
var notifications_requested;

var _getNotifications = function () {
  var $notifly = $('#notifly-icon');

  $notifly.click(function () {
    if (!notifications_requested) {
      notifications_requested = true;

      $.ajax({
        url: '<%= notifly.notifications_path %>',
        type: 'GET',
        error: _handleNotificationsError
      });
    }
  });
};

var _handleNotificationsError = function () {
  notifications_requested = false;
};

$(document).ready(function() {
  _getNotifications();
});